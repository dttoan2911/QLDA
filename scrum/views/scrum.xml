<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- kanban view of the Project Inherit -->
    <record id="view_project_sprint_kanban" model="ir.ui.view">
        <field name="name">project.project.inherit</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.view_project_kanban" />
        <!-- <field name="mode">primary</field> -->
        <!-- <field name="arch" type="xml">
            Count các Sprint trong PRoject
            <field name="rating_status" position="after">
                <field name="sprint_count"/>
            </field>
            <xpath expr="//a[hasclass('o_project_kanban_box')]" position="before">
                <a class="o_project_kanban_box" name="127" type="action">
                    <div>
                        <span class="o_value"><t t-esc="record.sprint_count.value"/></span>
                        <span class="o_label">Sprints</span>
                    </div>
                </a>
            </xpath>
            KIẾN THỨC KẾ THỪA VIEW
            C1: Tìm đến thẻ trong view để kế thừa
            <xpath expr="//field[@name='partner_id']" position="after"></xpath>
            C2: Tìm name của field trong view để kế thừa
            <field name="partner_id" position="after">
                <field name="item_name" />
            </field>
        </field> -->
    </record>

    <!-- form view of the Project Inherit -->
    <record id="project_project_sprint_view_form_simplified_inherit" model="ir.ui.view">
        <field name="name">project.project.sprint.inherit</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.project_project_view_form_simplified" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='name']" position="after">
                <field name="is_scrum" />
            </xpath>
        </field>
    </record>
    <!-- action of the Scrum Project Menu -->
    <record id="action_scrum_project" model="ir.actions.act_window">
        <field name="name">Scrum Project</field>
        <field name="res_model">project.project</field>
        <field name="view_type">form</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="view_ids" eval="[(5,0,0),
            (0, 0, {'view_mode': 'kanban', 'view_id': ref('view_project_sprint_kanban')}),
        ]" />
        <field name="domain">[('is_scrum', '=', True)]</field>
        <!-- <field name="context">{'default_is_scrum': True}</field> -->
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Mời bạn tạo Project
            </p>
        </field>
    </record>
    <!-- form view of the Product Backlog model  -->
    <record id="product_backlog_view_form" model="ir.ui.view">
        <field name="name">product.backlog.view.form</field>
        <field name="model">product.backlog</field>
        <field name="arch" type="xml">
            <form string="Backlogs">
                <header>
                    <field name="state" widget="statusbar" options="{'clickable': '1', 'fold_field': 'fold'}" />
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" readonly="1" />
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="name_backlog" />
                            <field name="priority" />
                            <field name="sprint_id" />
                        </group>
                    </group>
                    <notebook>
                        <page string="Tasks">
                            <group>
                                <field name="backlog_id" />
                            </group>
                        </page>
                        <page string="Mô tả thêm">
                            <group>
                                <field name="storypoint" />
                                <field name="description" placeholder="Mời bạn nhập mô tả yêu cầu" />
                                <field name="attachment" />
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user" />
                    <field name="activity_ids" widget="mail_activity" />
                    <field name="message_ids" widget="mail_thread" />
                </div>
            </form>
        </field>
    </record>
    <!-- tree view of the Product Backlog model -->
    <record id="product_backlog_view_tree" model="ir.ui.view">
        <field name="name">product.backlog.view.tree</field>
        <field name="model">product.backlog</field>
        <field name="arch" type="xml">
            <tree string="Backlogs">
                <field name="name" />
                <field name="name_backlog" />
                <field name="sprint_id" />
                <field name="state" />
                <field name="priority" />
                <field name="storypoint" sum="Tổng Story Point" />
            </tree>
        </field>
    </record>
    <!-- search view of the Product Backlog model -->
    <record id="product_backlog_view_search" model="ir.ui.view">
        <field name="name">product.backlog.view.search</field>
        <field name="model">product.backlog</field>
        <field name="arch" type="xml">
            <search string="Search Product Backlog">
                <field name="name" filter_domain="['|',('name','ilike',self),('name_backlog','ilike',self)]" />
                <field name="name" />
                <field name="name_backlog" />
                <separator />
                <filter string="Draft" name="draft" domain="[('state','=','draft')]" />
                <filter string="Confirm" name="confirm" domain="[('state','=','confirm')]" />
                <filter string="Done" name="done" domain="[('state','=','done')]" />
                <separator />
                <filter string="Low" name="0" domain="[('priority','=','0')]" />
                <filter string="Normal" name="1" domain="[('priority','=','1')]" />
                <group expand="0" string="Group By">
                    <filter string="Trạng thái" name="state" context="{'group_by':'state'}" />
                </group>
            </search>
        </field>
    </record>
    <!-- action of the Product Backlog Menu -->
    <record id="action_product_backlog" model="ir.actions.act_window">
        <field name="name">Product Backlog</field>
        <field name="res_model">product.backlog</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <!-- <field name="context">{"search_default_'t_workflow'":1}</field> -->
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Mời bạn tạo Product Backlog
            </p>
        </field>
    </record>
    <!-- form view of the Sprint model  -->
    <record id="sprint_sprint_view_form" model="ir.ui.view">
        <field name="name">sprint.sprint.view.form</field>
        <field name="model">sprint.sprint</field>
        <field name="arch" type="xml">
            <form string="Sprints">
                <header>
                    <button name="action_start_sprint" type="object" string="Start Sprint" states="draft" class="oe_highlight" />
                    <button name="action_complete_sprint" type="object" string="Complete Sprint" states="start" class="oe_highlight" />
                    <field name="state" widget="statusbar" />
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="open_sprint_backlogs" type="object" class="oe_stat_button" icon="fa-list-alt">
                            <field name="backlog_count" string="Backlogs" widget="statinfo" />
                        </button>
                    </div>
                    <div class="oe_title">
                        <h1>
                            <field name="name" readonly="1" />
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="user_sprint_id" options="{'no_create_edit': True, 'no_create': True, 'no_open': True}" />
                        </group>
                        <group>
                            <field name="start_date" />
                            <field name="end_date" />
                        </group>
                    </group>
                    <notebook>
                        <page string="Product Backlogs">
                            <field name="sprint_backlog_ids" widget="many2many" />
                        </page>
                        <page string="Sprint Goal">
                            <field name="sprint_goal" />
                        </page>
                        <page string="Define of done">
                            <field name="define_of_done" />
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user" />
                    <field name="activity_ids" widget="mail_activity" />
                    <field name="message_ids" widget="mail_thread" />
                </div>
            </form>
        </field>
    </record>
    <!-- tree view of the Sprint model -->
    <record id="sprint_sprint_view_tree" model="ir.ui.view">
        <field name="name">sprint.sprint.view.tree</field>
        <field name="model">sprint.sprint</field>
        <field name="arch" type="xml">
            <tree string="Sprints">
                <field name="name" />
                <field name="state" />
                <field name="start_date" />
                <field name="user_sprint_id" />
            </tree>
        </field>
    </record>
    <!-- action of the Sprint Menu -->
    <record id="action_sprint_sprint" model="ir.actions.act_window">
        <field name="name">Sprint</field>
        <field name="res_model">sprint.sprint</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <!-- <field name="context">{"search_default_draft":1}</field> -->
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                    Mời bạn tạo Sprint
                </p>
        </field>
    </record>
    <!-- form view of the Scrum Team model  -->
    <record id="scrum_team_view_form" model="ir.ui.view">
        <field name="name">scrum.team.view.form</field>
        <field name="model">scrum.team</field>
        <field name="arch" type="xml">
            <form string="Sprints">
                <sheet>
                    <group>
                        <group>
                            <field name="name" />
                        </group>
                        <group>
                            <field name="user_id" />
                        </group>
                    </group>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user" />
                    <field name="activity_ids" widget="mail_activity" />
                    <field name="message_ids" widget="mail_thread" />
                </div>
            </form>
        </field>
    </record>
    <!-- tree view of the Scrum Team model -->
    <record id="scrum_team_view_tree" model="ir.ui.view">
        <field name="name">scrum_team.view.tree</field>
        <field name="model">scrum.team</field>
        <field name="arch" type="xml">
            <tree string="Scrum Teams">
                <field name="name" />
                <field name="user_id" />
            </tree>
        </field>
    </record>
    <!-- action of the Scrum Team Menu -->
    <record id="action_scrum_team" model="ir.actions.act_window">
        <field name="name">Scrum Team</field>
        <field name="res_model">scrum.team</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                    Mời bạn tạo người dùng trong Scrum Project
                </p>
        </field>
    </record>
    <!-- form view of the Scrum Task model  -->
    <record id="scrum_task_view_form" model="ir.ui.view">
        <field name="name">scrum.task.view.form</field>
        <field name="model">scrum.task</field>
        <field name="arch" type="xml">
            <form string="Tasks">
                <sheet>
                    <group>
                        <group>
                            <field name="name" />
                        </group>
                        <group>
                            <field name="task_id" invisible="1" />
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <!-- action of the Scrum Task Menu -->
    <record id="action_scrum_task" model="ir.actions.act_window">
        <field name="name">Scrum Task</field>
        <field name="res_model">scrum.task</field>
        <field name="view_type">form</field>
        <field name="view_mode">form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Mời bạn tạo Task trong một Product Backlog
            </p>
        </field>
    </record>
    <!-- Main Menu -->
    <menuitem id="main_menu" name="Ứng dụng Quản trị Dự án" sequence="0" web_icon="scrum,static/src/img/scrum.png" />
    <!-- Scrum Project Menu -->
    <menuitem id="scrum_project_view_menu" name="Scrum Project" parent="main_menu" action="action_scrum_project" sequence="1" />
    <!-- Product Backlog Menu -->
    <menuitem id="product_backlog_view_menu" name="Product Backlog" parent="main_menu" action="action_product_backlog" sequence="2" />
    <!-- Sprint Menu -->
    <menuitem id="sprint_sprint_view_menu" name="Sprint" parent="main_menu" action="action_sprint_sprint" sequence="3" />
    <!-- Scrum Team Menu -->
    <menuitem id="scrum_team_view_menu" name="Scrum Team" parent="main_menu" action="action_scrum_team" sequence="4" />
</odoo>
